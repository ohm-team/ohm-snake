!function(){var e={958:function(e,t,i){e.exports=i(331)},134:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=(n=i(590))&&n.__esModule?n:{default:n},a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._=new o.default(t)}return r(e,[{key:"valueAt",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return this._.valueAt(e)}},{key:"applyTo",value:function(e,t){return this.getWebAudioAPIMethods(t).forEach((function(t){var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(t,3),n=i[0],r=i[1],o=i[2];e[n](r,o)})),this}},{key:"getWebAudioAPIMethods",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return this._.methods(e)}},{key:"clone",value:function(){return new e({attackTime:this._.attackTime,decayTime:this._.decayTime,sustainLevel:this._.sustainLevel,releaseTime:this._.releaseTime,gateTime:this._.gateTime,peakLevel:this._.peakLevel,epsilon:this._.epsilon,attackCurve:this._.attackCurve,decayCurve:this._.decayCurve,releaseCurve:this._.releaseCurve})}},{key:"duration",set:function(e){this._.setDuration(e)},get:function(){return this._.duration}},{key:"attackTime",set:function(e){this._.setAttackTime(e)},get:function(){return this._.attackTime}},{key:"decayTime",set:function(e){this._.setDecayTime(e)},get:function(){return this._.decayTime}},{key:"sustainTime",set:function(e){this._.setSustainTime(e)},get:function(){return this._.sustainTime}},{key:"sustainLevel",set:function(e){this._.setSustainLevel(e)},get:function(){return this._.sustainLevel}},{key:"releaseTime",set:function(e){this._.setReleaseTime(e)},get:function(){return this._.releaseTime}},{key:"gateTime",set:function(e){this._.setGateTime(e)},get:function(){return this._.gateTime}},{key:"peakLevel",set:function(e){this._.setPeakLevel(e)},get:function(){return this._.peakLevel}},{key:"epsilon",set:function(e){this._.setEpsilon(e)},get:function(){return this._.epsilon}},{key:"attackCurve",set:function(e){this._.setAttackCurve(e)},get:function(){return this._.attackCurve}},{key:"decayCurve",set:function(e){this._.setDecayCurve(e)},get:function(){return this._.decayCurve}},{key:"releaseCurve",set:function(e){this._.setReleaseCurve(e)},get:function(){return this._.releaseCurve}}]),e}();t.default=a,e.exports=t.default},590:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=r(i(904)),s=r(i(71)),u=r(i(907)),l=r(i(354)),c=r(i(221)),d=r(i(955)),h=i(274),f=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,e),this.attackTime=m((0,l.default)(t.attackTime,u.default.attackTime)),this.decayTime=m((0,l.default)(t.decayTime,u.default.decayTime)),this.sustainLevel=v((0,l.default)(t.sustainLevel,u.default.sustainLevel)),this.releaseTime=m((0,l.default)(t.releaseTime,u.default.releaseTime)),this.peakLevel=m((0,l.default)(t.peakLevel,u.default.peakLevel)),this.epsilon=p((0,l.default)(t.epsilon,u.default.epsilon)),this.attackCurve=g((0,l.default)(t.attackCurve,u.default.attackCurve)),this.decayCurve=g((0,l.default)(t.decayCurve,u.default.decayCurve)),this.releaseCurve=g((0,l.default)(t.releaseCurve,u.default.releaseCurve)),this.gateTime=u.default.gateTime,(0,d.default)(t.sustainTime)&&this.setSustainTime(t.sustainTime),(0,d.default)(t.gateTime)&&this.setGateTime(t.gateTime),(0,d.default)(t.duration)&&this.setDuration(t.duration),this.update()}return n(e,[{key:"valueAt",value:function(e){return s.default.at(this.envelope,e)}},{key:"methods",value:function(e){return this.envelope.map((function(t){var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(t,3),n=i[0],r=i[1],o=i[2];return[y(n),r,e+o]}))}},{key:"setDuration",value:function(e){var t=m(e);this.setGateTime(t-this.releaseTime)}},{key:"setAttackTime",value:function(e){this.attackTime=m(e),this.update()}},{key:"setDecayTime",value:function(e){this.decayTime=m(e),this.update()}},{key:"setSustainTime",value:function(e){var t=m(e);this.setGateTime(this.attackTime+this.decayTime+t)}},{key:"setSustainLevel",value:function(e){this.sustainLevel=v(e),this.update()}},{key:"setReleaseTime",value:function(e){this.releaseTime=m(e),this.update()}},{key:"setGateTime",value:function(e){this.gateTime=m(e),this.update()}},{key:"setPeakLevel",value:function(e){this.peakLevel=m(e),this.update()}},{key:"setEpsilon",value:function(e){this.epsilon=p(e),this.update()}},{key:"setAttackCurve",value:function(e){this.attackCurve=g(e),this.update()}},{key:"setDecayCurve",value:function(e){this.decayCurve=g(e),this.update()}},{key:"setReleaseCurve",value:function(e){this.releaseCurve=g(e),this.update()}},{key:"update",value:function(){this.sustainTime=Math.max(0,this.gateTime-this.attackTime-this.decayTime),this.duration=this.gateTime+this.releaseTime,this.envelope=a.default.build(this)}}]),e}();function m(e){return Math.max(0,e)||0}function v(e){return(0,c.default)(+e,0,1)||0}function p(e){return(0,c.default)(+e,2220446049250313e-31,.01)||.001}function g(e){return"exp"===e?"exp":"lin"}function y(e){switch(e){case h.SET:return"setValueAtTime";case h.LIN:return"linearRampToValueAtTime";case h.EXP:return"exponentialRampToValueAtTime"}}t.default=f,e.exports=t.default},904:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(i(533)),o=n(i(265)),a=n(i(710)),s=i(274);function u(e,t){return"exp"===e?{zero:t,calc:a.default,type:s.EXP}:{zero:0,calc:o.default,type:s.LIN}}function l(e){var t=[],i=u(e.attackCurve,e.epsilon),n=e.gateTime,r=e.gateTime,o=i.zero,a=Math.max(i.zero,e.peakLevel),l=i.calc(n,0,e.attackTime,o,a);return t.push([s.SET,o,0]),t.push([i.type,l,n]),t.push([s.SET,0,r]),t}function c(e){var t=[],i=u(e.attackCurve,e.epsilon),n=u(e.releaseCurve,e.epsilon),r=e.gateTime,o=e.gateTime+e.releaseTime,a=i.zero,l=Math.max(i.zero,e.peakLevel),c=i.calc(r,0,e.attackTime,a,l),d=n.zero;return t.push([s.SET,a,0]),t.push([i.type,c,r]),t.push([n.type,d,o]),t}t.default={build:function(e){var t=function(e){var t=e.attackTime,i=e.decayTime,n=e.gateTime,r=0;switch(r+=0<t?4:0,r+=0<i?2:0,r+=0<e.releaseTime?1:0){case 0:return function(e){var t=[],i=e.gateTime,n=e.gateTime,r=e.sustainLevel*e.peakLevel,o=e.sustainLevel*e.peakLevel;return t.push([s.SET,r,0]),t.push([s.SET,o,i]),t.push([s.SET,0,n]),t}(e);case 1:return function(e){var t=[],i=u(e.releaseCurve,e.epsilon),n=e.gateTime,r=e.gateTime+e.releaseTime,o=Math.max(i.zero,e.sustainLevel*e.peakLevel),a=Math.max(i.zero,e.sustainLevel*e.peakLevel),l=i.zero;return t.push([s.SET,o,0]),t.push([s.SET,a,n]),t.push([i.type,l,r]),t}(e);case 2:return n<=i?function(e){var t=[],i=u(e.decayCurve,e.epsilon),n=e.gateTime,r=e.gateTime,o=Math.max(i.zero,e.peakLevel),a=Math.max(i.zero,e.sustainLevel*e.peakLevel),l=i.calc(n,0,e.decayTime,o,a);return t.push([s.SET,o,0]),t.push([i.type,l,n]),t.push([s.SET,0,r]),t}(e):function(e){var t=[],i=u(e.decayCurve,e.epsilon),n=e.decayTime,r=e.gateTime,o=e.gateTime,a=Math.max(i.zero,e.peakLevel),l=Math.max(i.zero,e.sustainLevel*e.peakLevel),c=Math.max(i.zero,e.sustainLevel*e.peakLevel);return t.push([s.SET,a,0]),t.push([i.type,l,n]),t.push([s.SET,c,r]),t.push([s.SET,0,o]),t}(e);case 3:return n<=i?function(e){var t=[],i=u(e.decayCurve,e.epsilon),n=u(e.releaseCurve,e.epsilon),r=e.gateTime,o=e.gateTime+e.releaseTime,a=Math.max(i.zero,n.zero,e.peakLevel),l=Math.max(i.zero,n.zero,e.sustainLevel*e.peakLevel),c=i.calc(r,0,e.decayTime,a,l),d=Math.max(i.zero,n.zero);return t.push([s.SET,a,0]),t.push([i.type,c,r]),t.push([n.type,d,o]),t}(e):function(e){var t=[],i=u(e.decayCurve,e.epsilon),n=u(e.releaseCurve,e.epsilon),r=e.decayTime,o=e.gateTime,a=e.gateTime+e.releaseTime,l=Math.max(i.zero,n.zero,e.peakLevel),c=Math.max(i.zero,n.zero,e.sustainLevel*e.peakLevel),d=Math.max(i.zero,n.zero,e.sustainLevel*e.peakLevel),h=n.zero;return t.push([s.SET,l,0]),t.push([i.type,c,r]),t.push([s.SET,d,o]),t.push([n.type,h,a]),t}(e);case 4:return n<=t?l(e):function(e){var t=[],i=u(e.attackCurve,e.epsilon),n=e.attackTime,r=e.attackTime,o=e.gateTime,a=e.gateTime,l=i.zero,c=Math.max(i.zero,e.peakLevel),d=e.sustainLevel*e.peakLevel,h=e.sustainLevel*e.peakLevel;return t.push([s.SET,l,0]),t.push([i.type,c,n]),t.push([s.SET,d,r]),t.push([s.SET,h,o]),t.push([s.SET,0,a]),t}(e);case 5:return n<=t?c(e):function(e){var t=[],i=u(e.attackCurve,e.epsilon),n=u(e.releaseCurve,e.epsilon),r=e.attackTime,o=e.attackTime,a=e.gateTime,l=e.gateTime+e.releaseTime,c=i.zero,d=Math.max(i.zero,e.peakLevel),h=Math.max(n.zero,e.sustainLevel*e.peakLevel),f=Math.max(n.zero,e.sustainLevel*e.peakLevel),m=n.zero;return t.push([s.SET,c,0]),t.push([i.type,d,r]),t.push([s.SET,h,o]),t.push([s.SET,f,a]),t.push([n.type,m,l]),t}(e);case 6:return n<=t?l(e):n<=t+i?function(e){var t=[],i=u(e.attackCurve,e.epsilon),n=u(e.decayCurve,e.epsilon),r=e.attackTime,o=e.gateTime,a=e.gateTime,l=i.zero,c=Math.max(i.zero,n.zero,e.peakLevel),d=Math.max(n.zero,e.sustainLevel*e.peakLevel),h=n.calc(o,e.attackTime,e.attackTime+e.decayTime,c,d);return t.push([s.SET,l,0]),t.push([i.type,c,r]),t.push([n.type,h,o]),t.push([s.SET,0,a]),t}(e):function(e){var t=[],i=u(e.attackCurve,e.epsilon),n=u(e.decayCurve,e.epsilon),r=e.attackTime,o=e.attackTime+e.decayTime,a=e.gateTime,l=e.gateTime,c=i.zero,d=Math.max(i.zero,n.zero,e.peakLevel),h=Math.max(n.zero,e.sustainLevel*e.peakLevel),f=Math.max(n.zero,e.sustainLevel*e.peakLevel);return t.push([s.SET,c,0]),t.push([i.type,d,r]),t.push([n.type,h,o]),t.push([s.SET,f,a]),t.push([s.SET,0,l]),t}(e);case 7:return n<=t?c(e):n<=t+i?function(e){var t=[],i=u(e.attackCurve,e.epsilon),n=u(e.decayCurve,e.epsilon),r=u(e.releaseCurve,e.epsilon),o=e.attackTime,a=e.gateTime,l=e.gateTime+e.releaseTime,c=i.zero,d=Math.max(i.zero,n.zero,e.peakLevel),h=Math.max(n.zero,e.sustainLevel*e.peakLevel),f=n.calc(a,e.attackTime,e.attackTime+e.decayTime,d,h),m=Math.max(n.zero,r.zero);return t.push([s.SET,c,0]),t.push([i.type,d,o]),t.push([n.type,f,a]),t.push([r.type,m,l]),t}(e):function(e){var t=[],i=u(e.attackCurve,e.epsilon),n=u(e.decayCurve,e.epsilon),r=u(e.releaseCurve,e.epsilon),o=e.attackTime,a=e.attackTime+e.decayTime,l=e.gateTime,c=e.gateTime+e.releaseTime,d=i.zero,h=Math.max(i.zero,n.zero,e.peakLevel),f=Math.max(n.zero,r.zero,e.sustainLevel*e.peakLevel),m=Math.max(n.zero,r.zero,e.sustainLevel*e.peakLevel),v=Math.max(n.zero,r.zero);return t.push([s.SET,d,0]),t.push([i.type,h,o]),t.push([n.type,f,a]),t.push([s.SET,m,l]),t.push([r.type,v,c]),t}(e)}}(e);return r.default.reduce(t)}},e.exports=t.default},533:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(274);t.default={reduce:function(e){e=e.filter((function(e){return isFinite(e[n.TIME])}));var t=void 0;do{if(t=!1,2<=e.length){var i=e[e.length-2],r=e[e.length-1];i[n.VALUE]===r[n.VALUE]&&e.pop()}for(var o=e.length-2;o>=0;o--)i=e[o],r=e[o+1],i[n.TYPE]===n.SET&&(r[n.TYPE]!==n.SET?i[n.VALUE]!==r[n.VALUE]&&i[n.TIME]!==r[n.TIME]||(r[n.TYPE]=n.SET,t=!0):i[n.TIME]===r[n.TIME]&&(e.splice(o,1),t=!0))}while(t&&e.length);return e}},e.exports=t.default},71:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(i(265)),o=n(i(710)),a=i(274);t.default={at:function(e,t){for(var i=0,n=e.length-1;i<n;i++){var s=e[i],u=e[i+1];if(s[a.TIME]<=t&&t<u[a.TIME])switch(u[a.TYPE]){case a.LIN:return(0,r.default)(t,s[a.TIME],u[a.TIME],s[a.VALUE],u[a.VALUE]);case a.EXP:return(0,o.default)(t,s[a.TIME],u[a.TIME],s[a.VALUE],u[a.VALUE]);default:return s[a.VALUE]}}return e.length?e[e.length-1][a.VALUE]:0}},e.exports=t.default},274:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SET=0,t.LIN=1,t.EXP=2,t.TYPE=0,t.VALUE=1,t.TIME=2},907:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={attackTime:.01,decayTime:.3,sustainLevel:.5,releaseTime:1,gateTime:1/0,peakLevel:1,epsilon:.001,attackCurve:"lin",decayCurve:"lin",releaseCurve:"lin"},e.exports=t.default},331:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=i(134))&&n.__esModule?n:{default:n};t.default=r.default,e.exports=t.default},221:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i){return Math.max(t,Math.min(e,i))},e.exports=t.default},354:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return void 0!==e?e:t},e.exports=t.default},955:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"number"==typeof e&&isFinite(e)},e.exports=t.default},710:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i,n,r){return Math.pow(r/n,(e-t)/(i-t))*n},e.exports=t.default},265:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i,n,r){return(e-t)/(i-t)*(r-n)+n},e.exports=t.default},608:function(e){var t,i,n,r,o;t=console.log,i=console.warn,n=console.error,r=console.debug,o={unbind:function(){console.log=t,console.warn=i,console.error=n,console.debug=r},bind:function(e,o){if("function"!=typeof e)return console.error("You must pass a valid callback function."),!1;o=Boolean(o);const a="info",s="warn",u="error",l="debug";console.log=console.info=function(){t&&(o||t.call(console,...arguments),e(a,arguments))},console.warn=function(){i&&(o||i.call(console,...arguments),e(s,arguments))},console.error=function(){n&&(o||n.call(console,...arguments),e(u,arguments))},console.debug=function(){r&&(o||r.call(console,...arguments),e(l,arguments))}}},void 0!==e.exports?e.exports=o:window&&"object"==typeof window?window.ConsoleSubscriber=o:console.error("Failed to export module.")},90:function(e,t,i){"use strict";i.r(t)},553:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.enableMobileConsole=void 0;const r=n(i(608));t.enableMobileConsole=()=>{const e=[];r.default.bind(((t,i)=>{5===e.length&&e.shift(),e.push({category:t,message:i[0]}),document.getElementById("console").innerHTML=e.map((e=>`<p>${e.message}</p>`)).join("")}))}},115:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},143:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.startSnakeGame=void 0;const a=o(i(428)),s=i(131),u=i(719),l=i(782),c=i(664),d=i(414);var h,f,m,v,p,g,y=(new a.Vector3,new a.Matrix4,new a.Vector3),b={38:"backward",40:"forward",39:"right",37:"left",87:"up",83:"down",32:"pause"};function w(){var e,t=(e=Math.floor(5*Math.random()/2*2))-e%.1;return t>5?5-t-1:t-1}function T(e,t,i){const n=c.getApple(e,t,i,l.fieldSize.unitSize);return f.add(n),p.setCurrentTagPosition({x:e,y:t,z:i}),n}function M(){requestAnimationFrame(M),p.render(),h.lookAt(p.getHead().position),y.setFromMatrixPosition(p.cameraGoal.matrixWorld),h.position.lerp(y,.05),m.render(f,h)}t.startSnakeGame=(e,t)=>{const i=function(e,t=(()=>{})){var i=document.getElementById("snakeCanvas");(h=new a.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.01,10)).position.set(0,2,-2),f=new a.Scene,d.createLights(f),h.lookAt(f.position),v=new a.Object3D,(p=new s.Snake(f,.1,65280,v)).render(),p.onTagCollision=function(){t(),f.remove(g),g=T(w(),.1,w())},p.onSelfCollision=function(){e(),p.reset()},v.position.set(0,.4,-.5),g=T(w(),.05,w()),u.buildField(f,l.fieldSize),(m=new a.WebGLRenderer({canvas:i,antialias:!0})).setSize(window.innerWidth,window.innerHeight);var n={right:{enabled:!0,action:function(){p.turn("right"),n.pause.enabled=!0}},left:{enabled:!0,action:function(){p.turn("left"),n.pause.enabled=!0}},pause:{enabled:!1,action:function(){p.clear(),n.pause.enabled=!1}}};return document.addEventListener("keyup",(function(e){var t=n[b[e.keyCode]];t&&t.enabled&&t.action()}),!1),n.left.action(),{turnLeft:n.left.action,turnRight:n.right.action}}(e,t);return M(),i}},341:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=i(553);i(115),i(143);const u=i(970),l=i(263),c=i(409),d=i(393),h=i(646);i(90);const f=o(i(891)),m=$("#startButton"),v=$("#preloader"),p=$("#start"),g=$("#game"),y=$("#nameInput"),b=e=>a(void 0,void 0,void 0,(function*(){console.log("start game"),g.show(),p.hide(),h.startGameController(e),f.playMusic(),f.renderDebugButtons()}));window.onload=()=>a(void 0,void 0,void 0,(function*(){s.enableMobileConsole(),yield a(void 0,void 0,void 0,(function*(){v.show(),g.hide(),p.hide(),yield a(void 0,void 0,void 0,(function*(){return Promise.all([l.initImageCapture(),d.initVoiceService(),u.initHeadControl({onCameraPersmissionFailed:()=>alert("This game is head-controlled. You need to enable camera to play the game.")}),c.initVisibilityService(),f.default()]).then((()=>{v.hide(),p.show()})).catch((e=>{console.log(e)}))})),y.on("input",(()=>{y.val()?m.prop("disabled",!1):m.prop("disabled",!0)})),m.click((()=>a(void 0,void 0,void 0,(function*(){yield b(y.val())}))))}))}))},660:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_MOVEMENT=void 0,t.EVENT_MOVEMENT="movement";const i={mouseOpeningTreshold:.6,mouseClosingTreshold:.5,headMovementStartedTreshold:.15,headMovementStoppedTreshold:.08};class n extends EventTarget{constructor(e,n){super(),this.movementLocks={vertical:!1,horizontal:!1,mouseOpened:!1},this.state={isLoaded:!1,isDetected:!1,isEnabled:!1},this.gl=null,this.cv=null,this.videoTexture=null,this.videoTransformMat2=null,this.glHeadSearchDrawShaderProgram=null,this.headSearchUniformXys=null,this.headSearchUniformVideoTransformMat2=null,this.handleMouseOpening=e=>{if(e.ry<-1*this.settings.headMovementStartedTreshold||e.ry>this.settings.headMovementStartedTreshold)return;let i=5*(e.expressions[0]-.2);return i=Math.min(Math.max(i,0),1),i>this.settings.mouseOpeningTreshold&&!this.movementLocks.mouseOpened?(this.movementLocks.mouseOpened=!0,void this.dispatchEvent(new CustomEvent(t.EVENT_MOVEMENT,{detail:"mouth opened"}))):i<this.settings.mouseClosingTreshold&&this.movementLocks.mouseOpened?(this.movementLocks.mouseOpened=!1,void this.dispatchEvent(new CustomEvent(t.EVENT_MOVEMENT,{detail:"mouth closed"}))):void 0},this.handleMove=e=>{0!==e.rx&&this.handleAxisMovement({axis:"vertical",axisPosition:e.rx,maxValue:"down",minValue:"up"}),0!==e.ry&&this.handleAxisMovement({axis:"horizontal",axisPosition:e.ry,maxValue:"left",minValue:"right"})},this.handleAxisMovement=({axis:e,axisPosition:i,maxValue:n,minValue:r})=>i<-1*this.settings.headMovementStartedTreshold&&!this.movementLocks[e]?(this.movementLocks[e]=!0,void this.dispatchEvent(new CustomEvent(t.EVENT_MOVEMENT,{detail:r}))):i>this.settings.headMovementStartedTreshold&&!this.movementLocks[e]?(this.movementLocks[e]=!0,void this.dispatchEvent(new CustomEvent(t.EVENT_MOVEMENT,{detail:n}))):void(i>-1*this.settings.headMovementStoppedTreshold&&i<this.settings.headMovementStoppedTreshold&&(this.movementLocks[e]=!1)),this.settings=Object.assign(Object.assign({},i),n),window.JEEFACEFILTERAPI.init({canvasId:e,NNCPath:"./vendor/",animateDelay:20,callbackReady:(e,t)=>{if(e)return(e="WEBCAM_UNAVAILABLE")?void(n.onCameraPersmissionFailed&&n.onCameraPersmissionFailed()):void n.onError(new Error(e));this.gl=t.GL,this.videoTexture=t.videoTexture,this.videoTransformMat2=t.videoTransformMat2,this.cv=t.canvasElement,this.videoElement=t.videoElement,this.initHeadSearchDraw(),this.state.isLoaded=!0,n.onReady&&n.onReady()},callbackTrack:e=>{this.state.isEnabled&&(this.drawHeadSearch(e),this.handleMove(e),this.handleMouseOpening(e))}})}getVideoElement(){return this.videoElement}toggle(e){return this.state.isEnabled===e||(this.state.isEnabled=e),!0}compileShader(e,t,i){const n=this.gl.createShader(t);return this.gl.shaderSource(n,e),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)?n:(alert("ERROR IN "+i+" SHADER: "+this.gl.getShaderInfoLog(n)),null)}initHeadSearchDraw(){const e=this.compileShader("\n      attribute vec2 aat_position;\n      varying vec2 vUV;\n      \n      void main(void) {\n        gl_Position = vec4(aat_position, 0., 1.);\n        vUV = 0.5 + 0.5 * aat_position;\n        vUV.x = 1.-vUV.x; // mirror diplay\n      }",this.gl.VERTEX_SHADER,"VERTEX"),t=this.compileShader("\n      precision lowp float;\n      varying vec2 vUV;\n      \n      uniform sampler2D samplerVideo;\n      uniform mat2 videoTransformMat2;\n      uniform vec3 uxys;\n      \n      void main(void) {\n        vec2 uvVideoCentered = 2.0 * videoTransformMat2 * (vUV - 0.5);\n        vec2 uvVideo = uvVideoCentered + 0.5;\n        vec3 colorVideo = texture2D(samplerVideo, uvVideo).rgb;\n        vec2 pos = vUV*2.-vec2(1.,1.);\n        vec2 isInside = step(uxys.xy-uxys.z*vec2(1.,1.), pos);\n        isInside *= step(pos, uxys.xy+uxys.z*vec2(1.,1.));\n        vec2 blendCenterFactor = abs(pos-uxys.xy) / uxys.z;\n        float alpha = isInside.x * isInside.y * pow(max(blendCenterFactor.x, blendCenterFactor.y), 3.);\n        vec3 color = mix(colorVideo, vec3(0.,0.6,1.), alpha);\n        gl_FragColor = vec4(color,1.);\n      }",this.gl.FRAGMENT_SHADER,"FRAGMENT");this.glHeadSearchDrawShaderProgram=this.gl.createProgram(),this.gl.attachShader(this.glHeadSearchDrawShaderProgram,e),this.gl.attachShader(this.glHeadSearchDrawShaderProgram,t),this.gl.linkProgram(this.glHeadSearchDrawShaderProgram);const i=this.gl.getUniformLocation(this.glHeadSearchDrawShaderProgram,"samplerVideo");this.headSearchUniformXys=this.gl.getUniformLocation(this.glHeadSearchDrawShaderProgram,"uxys"),this.headSearchUniformVideoTransformMat2=this.gl.getUniformLocation(this.glHeadSearchDrawShaderProgram,"videoTransformMat2"),this.gl.useProgram(this.glHeadSearchDrawShaderProgram),this.gl.uniform1i(i,0)}drawHeadSearch(e){this.gl.viewport(0,0,this.cv.width,this.cv.height),this.gl.useProgram(this.glHeadSearchDrawShaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.videoTexture),this.gl.uniform3f(this.headSearchUniformXys,e.x,e.y,e.s),this.gl.uniformMatrix2fv(this.headSearchUniformVideoTransformMat2,!1,this.videoTransformMat2),this.gl.drawElements(this.gl.TRIANGLES,3,this.gl.UNSIGNED_SHORT,0)}}t.default=n},970:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.disableControls=t.enableControls=t.getVideoElement=t.initHeadControl=void 0;const a=o(i(660));let s,u;t.initHeadControl=({onCameraPersmissionFailed:e})=>new Promise(((t,i)=>{s=new a.default("head-preview",{onReady:t,onCameraPersmissionFailed:e,onError:i})})),t.getVideoElement=()=>{if(!s)throw new Error("Call initHeadControl first");return s.getVideoElement()},t.enableControls=({onMovement:e})=>{s.toggle(!0),u=t=>e(t.detail),s.addEventListener(a.EVENT_MOVEMENT,u)},t.disableControls=()=>{s.toggle(!1),u&&s.removeEventListener(a.EVENT_MOVEMENT,u)}},860:function(){var e=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};"createImageBitmap"in window||(window.createImageBitmap=function(t){return e(this,void 0,void 0,(function*(){return new Promise(((e,i)=>{let n=document.createElement("img");n.addEventListener("load",(function(){e(this)})),n.src=URL.createObjectURL(t)}))}))})},330:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CapturePolyfill=void 0;const r=i(970);t.CapturePolyfill={takePhoto:()=>n(void 0,void 0,void 0,(function*(){return new Promise((e=>{const t=r.getVideoElement(),i=document.createElement("canvas"),n=i.getContext("2d");i.width=t.videoWidth,i.height=t.videoHeight,n.drawImage(t,0,0),i.toBlob(e)}))}))}},140:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.gif=void 0;const r=n(i(967));t.gif=(e,t)=>{r.default.createGIF({images:e,gifWidth:300,gifHeight:300},(function(e){if(!e.error){const i=e.image,n=document.createElement("img");n.src=i,$(t).remove("img"),$(t).append(n)}}))}},263:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.initImageCapture=t.takePhoto=t.makeGif=void 0,i(330),i(860);const r=i(330),o=i(140);let a,s=!1;const u=[];t.makeGif=()=>{o.gif(u,"#gifContainer")},t.takePhoto=()=>n(void 0,void 0,void 0,(function*(){a?yield a.takePhoto().then((e=>createImageBitmap(e))).then((e=>{const t=document.querySelector("#takePhotoCanvas");t.style.display="block",function(e,t){e.width=getComputedStyle(e).width.split("px")[0],e.height=getComputedStyle(e).height.split("px")[0];let i=Math.min(e.width/t.width,e.height/t.height),n=(e.width-t.width*i)/2,r=(e.height-t.height*i)/2;e.getContext("2d").clearRect(0,0,e.width,e.height),e.getContext("2d").drawImage(t,0,0,t.width,t.height,n,r,t.width*i,t.height*i)}(t,e),u.push(t.toDataURL("image/jpeg"))})).catch((e=>{console.log(e)})):console.log("no image capture")})),t.initImageCapture=()=>n(void 0,void 0,void 0,(function*(){return s?Promise.resolve():(s=!0,navigator.mediaDevices.getUserMedia({video:!0}).then((e=>{try{const t=e.getVideoTracks()[0];a=new ImageCapture(t)}catch(e){a=r.CapturePolyfill}})).catch((()=>{alert("Image capture is not supported on your device :(")})))}))},309:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=new(window.AudioContext||window.webkitAudioContext),t=e.createGain();t.gain.value=.1,t.connect(e.destination);var i=e.currentTime,n=function(){var t=e.createScriptProcessor(4096,1,1);t.bits=4,t.normfreq=.1;var i=Math.pow(.5,t.bits),n=0,r=0;return t.onaudioprocess=function(e){for(var o=e.inputBuffer.getChannelData(0),a=e.outputBuffer.getChannelData(0),s=0;s<4096;s++)(n+=t.normfreq)>=1&&(n-=1,r=i*Math.floor(o[s]/i+.5)),a[s]=r},t}(),r=e.createOscillator();r.type="sawtooth",r.start(i);var o=e.createGain();n.connect(o),o.connect(t),r.connect(n),r.frequency.setValueAtTime(220,i),r.frequency.linearRampToValueAtTime(1760,i+4),o.gain.setValueAtTime(1,i),o.gain.setValueAtTime(1,i+4),o.gain.linearRampToValueAtTime(0,i+5)}},189:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(i(958));t.default=()=>()=>{!function(){const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.value=392,i.gain.value=.1;let n=new r.default({attackTime:.2,decayTime:.5,sustainLevel:.2,releaseTime:.5,gateTime:.5,peakLevel:.5,epsilon:.001,attackCurve:"lin",decayCurve:"lin",releaseCurve:"lin"});n.applyTo(i.gain,e.currentTime),t.start(e.currentTime),t.stop(e.currentTime+n.duration),t.connect(i),i.connect(e.destination)}()}},891:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderDebugButtons=t.playBoo=t.playGameOver=t.stopMusic=t.playMusic=void 0;const o=r(i(55)),a=r(i(309)),s=r(i(189));let u,l;t.default=()=>n(void 0,void 0,void 0,(function*(){return Promise.all([o.default()]).then((([e])=>{u=e,l=s.default()}))})),t.playMusic=()=>u.play(),t.stopMusic=()=>u.stop(),t.playGameOver=()=>a.default(),t.playBoo=()=>l(),t.renderDebugButtons=()=>{const e=document.createElement("fieldset");e.style.position="absolute",e.style.top="0",e.style.right="0",document.body.appendChild(e);const i=t=>{const i=document.createElement("button");i.textContent=`play:${t}`;let n=!1;i.onclick=()=>{const e=`${n?"stop":"play"}:${t}`,r=new CustomEvent(e);n=!n,i.textContent=e,window.dispatchEvent(r)},e.appendChild(i)};i("music"),i("crush"),i("boo"),window.addEventListener("play:music",t.playMusic),window.addEventListener("stop:music",t.stopMusic),window.addEventListener("play:crush",t.playGameOver),window.addEventListener("play:boo",t.playBoo)}},55:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n="/ohm-snake/audio/monsterslap.mp3";console.log({url:n}),t.default=function(){return i(this,void 0,void 0,(function*(){const e=new(window.AudioContext||window.webkitAudioContext),t=yield function(e,t){return i(this,void 0,void 0,(function*(){const t=yield fetch("/ohm-snake/audio/monsterslap.mp3"),i=yield t.arrayBuffer();return new Promise(((t,n)=>{e.decodeAudioData(i,(e=>{t(e)}),(e=>{n(e)}))}))}))}(e);let n,o=0;return{play:()=>{n=r(e,t),n.start(0,o,n.duration),o=0},stop:()=>{o=e.currentTime-0,n.stop(0)}}}))};const r=(e,t)=>{const i=e.createBufferSource();return i.buffer=t,i.connect(e.destination),i.loop=!0,i}},755:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_CHANGE=void 0,t.EVENT_CHANGE="change";class i extends EventTarget{constructor(){super(),this.handleVisibilityChange=()=>{const{hidden:e}=this.getVisibilityApiNames();document[e]?this.dispatchEvent(new CustomEvent(t.EVENT_CHANGE,{detail:"invisible"})):this.dispatchEvent(new CustomEvent(t.EVENT_CHANGE,{detail:"visible"}))},this.getVisibilityApiNames=()=>{var e,t;return void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),{hidden:e,visibilityChange:t}};const{visibilityChange:e}=this.getVisibilityApiNames();e||console.warn("Visiblity API is not availible. Some of the features will not work."),document.addEventListener(e,this.handleVisibilityChange,!1)}}t.default=i},409:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.unListenForVisibilityChange=t.listenForVisibilityChange=t.initVisibilityService=void 0;const a=o(i(755));let s,u;t.initVisibilityService=()=>(s=new a.default,Promise.resolve()),t.listenForVisibilityChange=({onVisibilityChange:e})=>{u=t=>e(t.detail),s.addEventListener(a.EVENT_CHANGE,u)},t.unListenForVisibilityChange=()=>{u&&s.removeEventListener(a.EVENT_CHANGE,u)}},393:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};let n;Object.defineProperty(t,"__esModule",{value:!0}),t.saySomething=t.randomPhrase=t.setUpUser=t.PHRASES=t.HELLO_PHRASE=t.initVoiceService=void 0,t.initVoiceService=()=>i(void 0,void 0,void 0,(function*(){return new Promise((e=>{setTimeout((()=>{n=window.speechSynthesis.getVoices().find((({lang:e})=>"en-GB"===e)),n?(console.log("voice init"),e(!0)):t.initVoiceService().then(e)}),500)}))})),t.HELLO_PHRASE="`Hi, %username%",t.PHRASES=["First blood!","You are doing great, %username%","Say hi to a LuckyWheel hackathon organizers, %username%","I'm just a snake, %username%, don't wait too much from me","An apple a day...you know","What are you doing tomorrow, %username%? Come play with me again","I am hungry!","Apple and snake...Truly biblical story","Yummy, want a bite, %username%?","I enjoy spending time with you, %username%","Where have you been my whole life, %username%?"];let r="";t.setUpUser=e=>{r=e},t.randomPhrase=()=>t.PHRASES[Math.floor(Math.random()*t.PHRASES.length)],t.saySomething=e=>{if(!n)return;const t=new SpeechSynthesisUtterance(e.replace("%username%",r));t.voice=n,t.volume=1,t.pitch=1,t.rate=1,speechSynthesis.cancel(),speechSynthesis.speak(t)}},782:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldSize=void 0,t.fieldSize={x:4,y:4,unitSize:.1}},184:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RAD270=t.RAD180=t.RAD90=t.HALF_PI=void 0,t.HALF_PI=Math.PI/2,t.RAD90=Math.PI/2,t.RAD180=Math.PI,t.RAD270=3*Math.PI/2},719:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.buildField=void 0;const a=o(i(428)),s=i(184),u=i(29);t.buildField=(e,t)=>{const i=new a.Mesh(new a.PlaneBufferGeometry(t.x,t.y,0),u.flat_blue);i.name="FloorPlane",i.rotateX(-s.HALF_PI);const n=new a.LineSegments(new a.EdgesGeometry(new a.BoxBufferGeometry(t.x,t.unitSize,t.y)),u.dashline);n.name="BoardOutline",n.computeLineDistances(),e.add(i),e.add(n)}},131:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Snake=void 0;const a=o(i(428)),s=i(253),u=[.011,.0125,.015,.016,.0165,.017,.018,.019,.02,.021,.022,.023,.024,.0245,.025];function l(e,t,i,n){this.snake=[],this.scene=e,this.size=t,this.color=i,this.pathPoints=[[0,0,0]],this.distance=t/4,this.initialSize=4,this.speedLevel=0,this.speed=u[this.speedLevel],this.liveTime=0,this.cameraGoal=n,this.direction=null,this.axis=null,this.onSelfCollision=function(){},this.onTagCollision=function(){},this.position=null,this.tagPosition=null,this.geometry=new a.BoxGeometry(this.size,this.size,this.size),this.material=new a.MeshNormalMaterial,this.init()}t.Snake=l,l.prototype={init:function(){for(var e=0;e<this.initialSize;e++)this.addCube();this.setDefaultPositions(),this.getHead().add(this.cameraGoal);const{x:t,y:i,z:n}=this.getTail().position;this.pathPoints.push([t,i,n])},setDefaultPositions:function(){var e=this;this.snake.forEach((function(t,i){t.position.z=(e.distance+e.size)*i*-1,t.position.y=e.size/2,t.position.x=0})),this.getHead().rotateY(0)},reset:function(){this.init()},selfCollision:function(){console.log("self collision"),this.onSelfCollision(),this.clear()},tagCollision:function(){this.speed=u[this.speedLevel++]||u[u.length-1],console.log("speed",this.speed),this.onTagCollision(),this.addCube()},setCurrentTagPosition:function(e){this.tagPosition=e},isHit:function(e,t,i){let n=e.y-i/2,r=e.y+i/2,o=e.x+i/2,a=e.x-i/2,s=e.z-i/2,u=e.z+i/2,l=t.y-i/2,c=t.y+i/2,d=t.x+i/2,h=t.x-i/2,f=t.z-i/2,m=t.z+i/2;return!(r<l||o<h||n>c||a>d||s>m||u<f)},getHead:function(){return this.snake[0]},getTail:function(){return this.snake[this.snake.length-1]},addPointToPath:function(e){this.pathPoints.splice(1,0,e)},updateFirstPoint:function(){this.pathPoints[0]=this.getPositionAsVector()},getPositionAsVector:function(){return this.position?[this.position.x,this.position.y,this.position.z]:[0,0,0]},createCube:function(e){return new a.Mesh(this.geometry,this.material)},addCube:function(){this.snake.push(this.createCube())},render:function(){this.liveTime++;var e=this;this.snake.forEach((function(t,i){if(null!==e.axis&&null!==e.direction)if(0===i)t.position[e.axis]+=e.direction*e.speed,e.position={x:t.position.x,y:t.position.y,z:t.position.z},e.updateFirstPoint(),e.tagPosition&&e.isHit(e.position,e.tagPosition,e.size)&&e.tagCollision();else{const n=i*(e.size+e.distance),[r,o,a]=s.findPointByDistance(e.pathPoints,n);t.position.set(r,o,a),1!==i&&e.isHit(e.position,t.position,e.size)&&e.selfCollision()}e.renderCube(t)}))},turn:function(e){if(this.addPointToPath(this.getPositionAsVector()),this.direction){if("right"==e){if(this.getHead().rotateY(-90*s.DEGTORAD),"z"==this.axis&&1==this.direction)return void this.left();if("z"==this.axis&&-1==this.direction)return void this.right();if("x"==this.axis&&1==this.direction)return void this.forward();if("x"==this.axis&&-1==this.direction)return void this.back()}if("left"==e){if(this.getHead().rotateY(90*s.DEGTORAD),"z"==this.axis&&1==this.direction)return void this.right();if("z"==this.axis&&-1==this.direction)return void this.left();if("x"==this.axis&&1==this.direction)return void this.back();if("x"==this.axis&&-1==this.direction)return void this.forward()}}else this.forward()},back:function(){this.axis="z",this.direction=-1,console.log("back")},forward:function(){this.axis="z",this.direction=1,console.log("fwd")},right:function(){this.axis="x",this.direction=1,console.log("right")},left:function(){this.axis="x",this.direction=-1,console.log("left")},clear:function(){this.axis=null,this.direction=null,this.pathPoints=[[0,0,0]]},renderCube:function(e){this.scene.add(e)}}},414:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createLights=void 0;const a=o(i(428));t.createLights=e=>{let t;t=new a.HemisphereLight(11184810,4473924,.7),t.position.set(0,-1,0),e.add(t),t=new a.DirectionalLight(15915390,2),e.add(t),t=new a.DirectionalLight(16109222,.8),t.position.set(0,0,1),e.add(t),t=new a.DirectionalLight(16109222,.3),t.position.set(0,0,-1),e.add(t),t=new a.DirectionalLight(11851483,.6),t.position.set(-1,0,0),e.add(t),t=new a.DirectionalLight(11851483,.6),t.position.set(1,0,0),e.add(t)}},29:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.pointsZ=t.pointsY=t.pointsX=t.indicator_inactive=t.indicator=t.dashline=t.board=t.food_highlight=t.food=t.snake_body=t.mid_highlight=t.arrow_highlight=t.arrow=t.mid_blue=t.sclera=t.cornea=t.dark_orange=t.flat_orange=t.flat_blue=t.collider=void 0;const a=o(i(428));t.collider=new a.MeshBasicMaterial({opacity:0,transparent:!0}),t.flat_blue=new a.MeshBasicMaterial({color:4768986,opacity:.1,transparent:!0}),t.flat_orange=new a.MeshLambertMaterial({color:16494681}),t.dark_orange=new a.MeshPhongMaterial({color:13258283}),t.cornea=new a.MeshPhongMaterial({color:16777215,specular:16777215,shininess:1,transparent:!0,opacity:.3}),t.sclera=new a.MeshPhongMaterial({color:16777215}),t.mid_blue=new a.MeshBasicMaterial({color:3563137}),t.arrow=new a.MeshBasicMaterial({color:25514,transparent:!0}),t.arrow_highlight=new a.MeshBasicMaterial({color:16756735}),t.mid_highlight=new a.MeshBasicMaterial({color:3604479}),t.snake_body=new a.MeshLambertMaterial({color:6525713}),t.food=new a.MeshLambertMaterial({color:6032141}),t.food_highlight=new a.MeshLambertMaterial({color:15533834}),t.board=new a.LineBasicMaterial({color:16576415,linewidth:5}),t.dashline=new a.LineBasicMaterial({color:16755200,linewidth:5}),t.indicator=new a.LineDashedMaterial({color:5953226,dashSize:1,gapSize:2}),t.indicator_inactive=new a.LineDashedMaterial({color:5953226,dashSize:1,gapSize:2,opacity:.1,transparent:!0}),t.pointsX=new a.PointsMaterial({size:.1,sizeAttenuation:!0,color:16083266}),t.pointsY=new a.PointsMaterial({size:.1,sizeAttenuation:!0,color:9499970}),t.pointsZ=new a.PointsMaterial({size:.1,sizeAttenuation:!0,color:4360181})},664:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getApple=void 0;const a=o(i(428)),s=i(184),u=i(29),l=i(253),c=new a.FBXLoader;t.getApple=(e,t,i,n)=>{const r=new a.BoxBufferGeometry(n,n,n),o=new a.Mesh(r,u.collider);o.name="Food";const d=new a.Group;return d.rotateY(l.choice([s.RAD90,s.RAD180,s.RAD270])),c.load("./models/fruit.fbx",(function(e){e.name="FoodFBX",e.scale.set(n,n,n),e.children[2].material=u.food,d.add(e)})),o.add(d),o.position.set(e,t,i),o}},253:function(e,t){"use strict";function i([e,t,i],[n,r,o],a){return[e+(n-e)*a,t,i+(o-i)*a]}Object.defineProperty(t,"__esModule",{value:!0}),t.findPointByDistance=t.midpoint=t.dist=t.choice=t.DEGTORAD=void 0,t.DEGTORAD=.01745327,t.choice=e=>e[Math.floor(Math.random()*e.length)],t.dist=([e,t,i],[n,r,o])=>{var a=e-n,s=i-o;return Math.sqrt(a*a+s*s)},t.midpoint=i,t.findPointByDistance=(e,n)=>{let r=0,o=null;return e.forEach(((a,s)=>{if(o);else{if(e.length<=s+1)return void(o=a);let u=e[s+1],l=t.dist(a,u);if(r+l>=n)return void(o=i(a,u,(n-r)/l));r+=l}})),o}},646:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.startGameController=void 0;const r=i(143),o=i(970),a=i(263),s=i(891),u=i(409),l=i(393),c=()=>{l.saySomething(l.randomPhrase())};t.startGameController=e=>n(void 0,void 0,void 0,(function*(){try{l.setUpUser(e),l.saySomething(l.HELLO_PHRASE);const{turnLeft:t,turnRight:i}=r.startSnakeGame(d,c),n=e=>{a.takePhoto(),"left"===e&&(t(),s.playBoo()),"right"===e&&(i(),s.playBoo())};o.enableControls({onMovement:n});const h=e=>{"visible"!==e?console.log("pause!"):console.log("unpause!")};u.listenForVisibilityChange({onVisibilityChange:h})}catch(e){console.error(e),alert(e)}}));const d=()=>{$("#game").hide(),$("#gameover").show(),$("#replay").click((()=>{window.location.reload()})),a.makeGif(),s.stopMusic(),s.playGameOver()}},967:function(e,t){var i;!function(n,r,o,a){"use strict";var s,u,l={URL:n.URL||n.webkitURL||n.mozURL||n.msURL,getUserMedia:(u=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia||o.msGetUserMedia,u?u.bind(o):u),requestAnimFrame:n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame,requestTimeout:function(e,t){if(e=e||l.noop,t=t||0,!l.requestAnimFrame)return setTimeout(e,t);var i=(new Date).getTime(),n=new Object,r=l.requestAnimFrame;return n.value=r((function o(){(new Date).getTime()-i>=t?e.call():n.value=r(o)})),n},Blob:n.Blob||n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,btoa:(s=n.btoa||function(e){for(var t="",i=0,n=e.length,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=void 0;i<n;)u=(o=e.charCodeAt(i++))>>2,l=(3&o)<<4|(a=e.charCodeAt(i++))>>4,c=(15&a)<<2|(s=e.charCodeAt(i++))>>6,d=63&s,isNaN(a)?c=d=64:isNaN(s)&&(d=64),t=t+r.charAt(u)+r.charAt(l)+r.charAt(c)+r.charAt(d);return t},s?s.bind(n):l.noop),isObject:function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){return l.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&"function"==typeof e},isElement:function(e){return e&&1===e.nodeType},isString:function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},isSupported:{canvas:function(){var e=r.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return n.Worker},blob:function(){return l.Blob},Uint8Array:function(){return n.Uint8Array},Uint32Array:function(){return n.Uint32Array},videoCodecs:function(){var e=r.createElement("video"),t={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{e&&e.canPlayType&&(t.mp4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogv=""!==e.canPlayType('video/ogg; codecs="theora"'),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=-1!==e.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(e){}return t}()},noop:function(){},each:function(e,t){var i=void 0,n=void 0;if(l.isArray(e))for(i=-1,n=e.length;++i<n&&!1!==t(i,e[i]););else if(l.isObject(e))for(i in e)if(e.hasOwnProperty(i)&&!1===t(i,e[i]))break},mergeOptions:function(e,t){if(l.isObject(e)&&l.isObject(t)&&Object.keys){var i={};return l.each(e,(function(t,n){i[t]=e[t]})),l.each(t,(function(n,r){var o=t[n];l.isObject(o)&&e[n]?i[n]=l.mergeOptions(e[n],o):i[n]=o})),i}},setCSSAttr:function(e,t,i){l.isElement(e)&&(l.isString(t)&&l.isString(i)?e.style[t]=i:l.isObject(t)&&l.each(t,(function(t,i){e.style[t]=i})))},removeElement:function(e){l.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!l.isString(e))return{};try{var t=new l.Blob([e],{type:"text/javascript"}),i=l.URL.createObjectURL(t);return{objectUrl:i,worker:new Worker(i)}}catch(e){return""+e}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{};if(!r.body||!1===e.resizeFont)return e.fontSize;var t=e.text,i=e.gifWidth,n=parseInt(e.fontSize,10),o=parseInt(e.minFontSize,10),s=r.createElement("div"),u=r.createElement("span");for(s.setAttribute("width",i),s.appendChild(u),u.innerHTML=t,u.style.fontSize=n+"px",u.style.textIndent="-9999px",u.style.visibility="hidden",r.body.appendChild(u);u.offsetWidth>i&&n>=o;)u.style.fontSize=--n+"px";return r.body.removeChild(u),n+"px"},webWorkerError:!1},c=Object.freeze({default:l}),d={validate:function(e){e=l.isObject(e)?e:{};var t={};return l.each(d.validators,(function(i,n){var r=n.errorCode;if(!e[r]&&!n.condition)return(t=n).error=!0,!1})),delete t.condition,t},isValid:function(e){return!0!==d.validate(e).error},validators:[{condition:l.isFunction(l.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:l.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:l.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:l.isFunction(l.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:l.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:l.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:l.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},h=Object.freeze({default:d}),f=function(){},m={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:f,completeCallback:f,saveRenderingContexts:!1,savedRenderingContexts:[],showFrameText:!0,crossOrigin:"Anonymous",waterMark:null,waterMarkHeight:null,waterMarkWidth:null,waterMarkXCoordinate:1,waterMarkYCoordinate:1},v=Object.freeze({default:m});function p(){return d.isValid()}function g(){var e,t,i,n,r,o=256,a=499,s=491,u=487,l=503,c=3*l,d=o-1,h=4,f=100,m=16,v=1<<m,p=10,g=10,y=v>>g,b=v<<p-g,w=o>>3,T=6,M=1<<T,k=w*M,E=30,_=10,S=1<<_,C=8,x=1<<C,P=_+C,O=1<<P,L=[],A=[],z=[],V=[];function j(e,a,s){var u,l;for(t=e,i=a,n=s,r=new Array(o),u=0;u<o;u++)r[u]=new Array(4),(l=r[u])[0]=l[1]=l[2]=(u<<h+8)/o|0,z[u]=v/o|0,A[u]=0}function F(){for(var e=[],t=new Array(o),i=0;i<o;i++)t[r[i][3]]=i;for(var n=0,a=0;a<o;a++){var s=t[a];e[n++]=r[s][0],e[n++]=r[s][1],e[n++]=r[s][2]}return e}function R(){var e,t,i,n,a,s,u,l;for(u=0,l=0,e=0;e<o;e++){for(i=e,n=(a=r[e])[1],t=e+1;t<o;t++)(s=r[t])[1]<n&&(i=t,n=s[1]);if(s=r[i],e!=i&&(t=s[0],s[0]=a[0],a[0]=t,t=s[1],s[1]=a[1],a[1]=t,t=s[2],s[2]=a[2],a[2]=t,t=s[3],s[3]=a[3],a[3]=t),n!=u){for(L[u]=l+e>>1,t=u+1;t<n;t++)L[t]=e;u=n,l=e}}for(L[u]=l+d>>1,t=u+1;t<256;t++)L[t]=d}function I(){var r,o,d,m,v,p,g,y,b,w,M,_,C,P;for(i<c&&(n=1),e=30+(n-1)/3,_=t,C=0,P=i,w=(M=i/(3*n))/f|0,y=S,(g=(p=k)>>T)<=1&&(g=0),r=0;r<g;r++)V[r]=y*((g*g-r*r)*x/(g*g));for(b=i<c?3:i%a!=0?3*a:i%s!=0?3*s:i%u!=0?3*u:3*l,r=0;r<M;)if(B(y,o=G(d=(255&_[C+0])<<h,m=(255&_[C+1])<<h,v=(255&_[C+2])<<h),d,m,v),0!==g&&W(g,o,d,m,v),(C+=b)>=P&&(C-=i),0===w&&(w=1),++r%w==0)for(y-=y/e,(g=(p-=p/E)>>T)<=1&&(g=0),o=0;o<g;o++)V[o]=y*((g*g-o*o)*x/(g*g))}function D(e,t,i){var n,a,s,u,l,c,d;for(l=1e3,d=-1,a=(n=L[t])-1;n<o||a>=0;)n<o&&((s=(c=r[n])[1]-t)>=l?n=o:(n++,s<0&&(s=-s),(u=c[0]-e)<0&&(u=-u),(s+=u)<l&&((u=c[2]-i)<0&&(u=-u),(s+=u)<l&&(l=s,d=c[3])))),a>=0&&((s=t-(c=r[a])[1])>=l?a=-1:(a--,s<0&&(s=-s),(u=c[0]-e)<0&&(u=-u),(s+=u)<l&&((u=c[2]-i)<0&&(u=-u),(s+=u)<l&&(l=s,d=c[3]))));return d}function U(){return I(),H(),R(),F()}function H(){var e;for(e=0;e<o;e++)r[e][0]>>=h,r[e][1]>>=h,r[e][2]>>=h,r[e][3]=e}function W(e,t,i,n,a){var s,u,l,c,d,h,f;for((l=t-e)<-1&&(l=-1),(c=t+e)>o&&(c=o),s=t+1,u=t-1,h=1;s<c||u>l;){if(d=V[h++],s<c){f=r[s++];try{f[0]-=d*(f[0]-i)/O|0,f[1]-=d*(f[1]-n)/O|0,f[2]-=d*(f[2]-a)/O|0}catch(e){}}if(u>l){f=r[u--];try{f[0]-=d*(f[0]-i)/O|0,f[1]-=d*(f[1]-n)/O|0,f[2]-=d*(f[2]-a)/O|0}catch(e){}}}}function B(e,t,i,n,o){var a=r[t],s=e/S;a[0]-=s*(a[0]-i)|0,a[1]-=s*(a[1]-n)|0,a[2]-=s*(a[2]-o)|0}function G(e,t,i){var n,a,s,u,l,c,d,f,v,w;for(v=f=~(1<<31),d=c=-1,n=0;n<o;n++)(a=(w=r[n])[0]-e)<0&&(a=-a),(s=w[1]-t)<0&&(s=-s),a+=s,(s=w[2]-i)<0&&(s=-s),(a+=s)<f&&(f=a,c=n),(u=a-(A[n]>>m-h))<v&&(v=u,d=n),l=z[n]>>g,z[n]-=l,A[n]+=l<<p;return z[c]+=y,A[c]-=b,d}j.apply(this,arguments);var N={};return N.map=D,N.process=U,N}function y(){try{this.onmessage=function(t){var i,n=t.data||{};n.gifshot&&(i=e.run(n),postMessage(i))}}catch(e){}var e={dataToRGB:function(e,t,i){for(var n=t*i*4,r=0,o=[];r<n;)o.push(e[r++]),o.push(e[r++]),o.push(e[r++]),r++;return o},componentizedPaletteToArray:function(e){e=e||[];for(var t=[],i=0;i<e.length;i+=3){var n=e[i],r=e[i+1],o=e[i+2];t.push(n<<16|r<<8|o)}return t},processFrameWithQuantizer:function(e,t,i,n){for(var r=this.dataToRGB(e,t,i),o=new g(r,r.length,n),a=o.process(),s=new Uint32Array(this.componentizedPaletteToArray(a)),u=t*i,l=new Uint8Array(u),c=0,d=0;d<u;d++){var h=r[c++],f=r[c++],m=r[c++];l[d]=o.map(h,f,m)}return{pixels:l,palette:s}},run:function(e){var t=e=e||{},i=t.height,n=(t.palette,t.sampleInterval),r=t.width,o=e.data;return this.processFrameWithQuantizer(o,r,i,n)}};return e}function b(e,t,i,n){var r=0,o=(n=n===a?{}:n).loop===a?null:n.loop,s=n.palette===a?null:n.palette;if(t<=0||i<=0||t>65535||i>65535)throw"Width/Height invalid.";if(e[r++]=71,e[r++]=73,e[r++]=70,e[r++]=56,e[r++]=57,e[r++]=97,e[r++]=255&t,e[r++]=t>>8&255,e[r++]=255&i,e[r++]=i>>8&255,e[r++]=0|(null!==s?128:0),e[r++]=0,e[r++]=0,null!==o){if(o<0||o>65535)throw"Loop count invalid.";e[r++]=33,e[r++]=255,e[r++]=11,e[r++]=78,e[r++]=69,e[r++]=84,e[r++]=83,e[r++]=67,e[r++]=65,e[r++]=80,e[r++]=69,e[r++]=50,e[r++]=46,e[r++]=48,e[r++]=3,e[r++]=1,e[r++]=255&o,e[r++]=o>>8&255,e[r++]=0}var u=!1;this.addFrame=function(t,i,n,o,l,c){if(!0===u&&(--r,u=!1),c=c===a?{}:c,t<0||i<0||t>65535||i>65535)throw"x/y invalid.";if(n<=0||o<=0||n>65535||o>65535)throw"Width/Height invalid.";if(l.length<n*o)throw"Not enough pixels for the frame size.";var d=!0,h=c.palette;if(h!==a&&null!==h||(d=!1,h=s),h===a||null===h)throw"Must supply either a local or global palette.";for(var f=function(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}(h),m=0;f>>=1;)++m;f=1<<m;var v=c.delay===a?0:c.delay,p=c.disposal===a?0:c.disposal;if(p<0||p>3)throw"Disposal out of range.";var g=!1,y=0;if(c.transparent!==a&&null!==c.transparent&&(g=!0,(y=c.transparent)<0||y>=f))throw"Transparent color index.";if((0!==p||g||0!==v)&&(e[r++]=33,e[r++]=249,e[r++]=4,e[r++]=p<<2|(!0===g?1:0),e[r++]=255&v,e[r++]=v>>8&255,e[r++]=y,e[r++]=0),e[r++]=44,e[r++]=255&t,e[r++]=t>>8&255,e[r++]=255&i,e[r++]=i>>8&255,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=255&o,e[r++]=o>>8&255,e[r++]=!0===d?128|m-1:0,!0===d)for(var b=0,w=h.length;b<w;++b){var T=h[b];e[r++]=T>>16&255,e[r++]=T>>8&255,e[r++]=255&T}r=function(e,t,i,n){e[t++]=i;var r=t++,o=1<<i,s=o-1,u=o+1,l=u+1,c=i+1,d=0,h=0;function f(i){for(;d>=i;)e[t++]=255&h,h>>=8,d-=8,t===r+256&&(e[r]=255,r=t++)}function m(e){h|=e<<d,d+=c,f(8)}var v=n[0]&s,p={};m(o);for(var g=1,y=n.length;g<y;++g){var b=n[g]&s,w=v<<8|b,T=p[w];if(T===a){for(h|=v<<d,d+=c;d>=8;)e[t++]=255&h,h>>=8,d-=8,t===r+256&&(e[r]=255,r=t++);4096===l?(m(o),l=u+1,c=i+1,p={}):(l>=1<<c&&++c,p[w]=l++),v=b}else v=T}return m(v),m(u),f(1),r+1===t?e[r]=0:(e[r]=t-r-1,e[t++]=0),t}(e,r,m<2?2:m,l)},this.end=function(){return!1===u&&(e[r++]=59,u=!0),r}}var w=function(){},T=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=w,this.onRenderProgressCallback=w,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};function M(e,t){e.getBase64GIF((function(e){t({error:!1,errorCode:"",errorMsg:"",image:e})}))}T.prototype={workerMethods:y(),initializeWebWorkers:function(e){var t,i=g.toString()+"("+y.toString()+"());",n=void 0,o=void 0,a=void 0,s=-1,u="";for(t=e.numWorkers;++s<t;)n=l.createWebWorker(i),l.isObject(n)?(o=n.objectUrl,a=n.worker,this.workers.push({worker:a,objectUrl:o}),this.availableWorkers.push(a)):(u=n,l.webWorkerError=!!n);this.workerError=u,this.canvas=r.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return e}(),bufferToString:function(e){for(var t=e.length,i="",n=-1;++n<t;)i+=this.byteMap[e[n]];return i},onFrameFinished:function(e){var t=this,i=t.frames,n=!!(t.options.images||[]).length,r=i.every((function(e){return!e.beingProcessed&&e.done}));t.numRenderedFrames++,n&&e(t.numRenderedFrames/i.length),t.onRenderProgressCallback(.75*t.numRenderedFrames/i.length),r?t.generatingGIF||t.generateGIF(i,t.onRenderCompleteCallback):l.requestTimeout((function(){t.processNextFrame()}),1)},processFrame:function(e){var t=this,i=(this.options,this.options),n=i.progressCallback,r=i.sampleInterval,o=this.frames,s=void 0,u=void 0,l=function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},i=e.data;delete s.data,s.pixels=Array.prototype.slice.call(i.pixels),s.palette=Array.prototype.slice.call(i.palette),s.done=!0,s.beingProcessed=!1,t.freeWorker(u),t.onFrameFinished(n)};(s=o[e]).beingProcessed||s.done?this.onFrameFinished():(s.sampleInterval=r,s.beingProcessed=!0,s.gifshot=!0,(u=this.getWorker())?(u.onmessage=l,u.postMessage(s)):l({data:t.workerMethods.run(s)}))},startRendering:function(e){this.onRenderCompleteCallback=e;for(var t=0;t<this.options.numWorkers&&t<this.frames.length;t++)this.processFrame(t)},processNextFrame:function(){for(var e=-1,t=0;t<this.frames.length;t++){var i=this.frames[t];if(!i.done&&!i.beingProcessed){e=t;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,t){var i=[],n={loop:this.repeat},r=this.options,o=r.interval,a=r.frameDuration,s=!!r.images.length,u=r.gifHeight,c=r.gifWidth,d=new b(i,c,u,n),h=this.onRenderProgressCallback,f=s?100*o:0,m=void 0;this.generatingGIF=!0,l.each(e,(function(t,i){var n=i.palette;h(.75+.25*i.position*1/e.length);for(var r=0;r<a;r++)d.addFrame(0,0,c,u,i.pixels,{palette:n,delay:f})})),d.end(),h(1),this.frames=[],this.generatingGIF=!1,l.isFunction(t)&&(m=this.bufferToString(i),t("data:image/gif;base64,"+l.btoa(m)))},setRepeat:function(e){this.repeat=e},addFrame:function(e,t,i){t=l.isObject(t)?t:{};var n=this,r=n.ctx,o=n.options,a=o.gifWidth,s=o.gifHeight,u=l.getFontSize(t),c=t,d=c.filter,h=c.fontColor,f=c.fontFamily,m=c.fontWeight,v=(c.gifHeight,c.gifWidth,c.text),p=c.textAlign,g=c.textBaseline,y=c.waterMark,b=c.waterMarkHeight,w=c.waterMarkWidth,T=c.waterMarkXCoordinate,M=c.waterMarkYCoordinate,k=t.textXCoordinate?t.textXCoordinate:"left"===p?1:"right"===p?a:a/2,E=t.textYCoordinate?t.textYCoordinate:"top"===g?1:"center"===g?s/2:s,_=m+" "+u+" "+f,S=i&&t.showFrameText?i:v,C=void 0;try{r.filter=d,r.drawImage(e,0,0,a,s),S&&(r.font=_,r.fillStyle=h,r.textAlign=p,r.textBaseline=g,r.fillText(S,k,E)),y&&r.drawImage(y,T,M,w,b),C=r.getImageData(0,0,a,s),n.addFrameImageData(C)}catch(e){return""+e}},addFrameImageData:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=this.frames,i=e.data;this.frames.push({data:i,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:t.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var t=this;t.startRendering((function(i){t.destroyWorkers(),l.requestTimeout((function(){e(i)}),0)}))},destroyWorkers:function(){if(!this.workerError){var e=this.workers;l.each(e,(function(e,t){var i=t.worker,n=t.objectUrl;i.terminate(),l.URL.revokeObjectURL(n)}))}}};var k=function(){},E=function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=arguments[1];t=l.isFunction(t)?t:k;var i=r.createElement("canvas"),n=void 0,o=e.images,s=!!o.length,u=e.cameraStream,c=e.crop,d=e.filter,h=e.fontColor,f=e.fontFamily,m=e.fontWeight,v=e.keepCameraOn,p=(e.numWorkers,e.progressCallback),g=e.saveRenderingContexts,y=e.savedRenderingContexts,b=e.text,w=e.textAlign,M=e.textBaseline,E=e.videoElement,_=e.videoHeight,S=e.videoWidth,C=e.webcamVideoElement,x=e.waterMark,P=e.waterMarkHeight,O=e.waterMarkWidth,L=e.waterMarkXCoordinate,A=e.waterMarkYCoordinate,z=Number(e.gifWidth),V=Number(e.gifHeight),j=Number(e.interval),F=(Number(e.sampleInterval),s?0:1e3*j),R=[],I=y.length?y.length:e.numFrames,D=I,U=new T(e),H=l.getFontSize(e),W=e.textXCoordinate?e.textXCoordinate:"left"===w?1:"right"===w?z:z/2,B=e.textYCoordinate?e.textYCoordinate:"top"===M?1:"center"===M?V/2:V,G=m+" "+H+" "+f,N=c?Math.floor(c.scaledWidth/2):0,q=c?S-c.scaledWidth:0,X=c?Math.floor(c.scaledHeight/2):0,Y=c?_-c.scaledHeight:0,$=function e(){var i=D-1;function r(){var r;g&&R.push(n.getImageData(0,0,z,V)),x&&n.drawImage(x,L,A,O,P),b&&(n.font=G,n.fillStyle=h,n.textAlign=w,n.textBaseline=M,n.fillText(b,W,B)),r=n.getImageData(0,0,z,V),U.addFrameImageData(r),p((I-(D=i))/I),i>0&&l.requestTimeout(e,F),D||U.getBase64GIF((function(e){t({error:!1,errorCode:"",errorMsg:"",image:e,cameraStream:u,videoElement:E,webcamVideoElement:C,savedRenderingContexts:R,keepCameraOn:v})}))}y.length?(n.putImageData(y[I-D],0,0),r()):function e(){try{q>S&&(q=S),Y>_&&(Y=_),N<0&&(N=0),X<0&&(X=0),n.filter=d,n.drawImage(E,N,X,q,Y,0,0,z,V),r()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;l.requestTimeout(e,100)}}()};I=I!==a?I:10,j=j!==a?j:.1,i.width=z,i.height=V,n=i.getContext("2d"),function e(){y.length||0!==E.currentTime?$():l.requestTimeout(e,100)}()},_={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function e(t){e.attempts=e.attempts||0;var i=t.cameraStream,n=t.completedCallback,r=t.videoElement;r&&(r.videoWidth>0&&r.videoHeight>0?(r.removeEventListener("loadeddata",_.findVideoSize),n({videoElement:r,cameraStream:i,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):e.attempts<10?(e.attempts+=1,l.requestTimeout((function(){_.findVideoSize(t)}),400)):n({videoElement:r,cameraStream:i,videoWidth:_.defaultVideoDimensions.width,videoHeight:_.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){l.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var t=l.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,i=e.cameraStream,n=e.completedCallback,r=e.streamedCallback,o=e.videoElement;if(l.isFunction(r)&&r(),t){if(l.isString(t))o.src=t,o.innerHTML='<source src="'+t+'" type="video/'+l.getExtension(t)+'" />';else if(t instanceof Blob){try{o.src=l.URL.createObjectURL(t)}catch(e){}o.innerHTML='<source src="'+t+'" type="'+t.type+'" />'}}else if(o.mozSrcObject)o.mozSrcObject=i;else if(l.URL)try{o.srcObject=i,o.src=l.URL.createObjectURL(i)}catch(e){o.srcObject=i}o.play(),l.requestTimeout((function e(){e.count=e.count||0,!0===_.loadedData?(_.findVideoSize({videoElement:o,cameraStream:i,completedCallback:n}),_.loadedData=!1):(e.count+=1)>10?_.findVideoSize({videoElement:o,cameraStream:i,completedCallback:n}):e()}),0)},startStreaming:function(e){var t=l.isFunction(e.error)?e.error:l.noop,i=l.isFunction(e.streamed)?e.streamed:l.noop,n=l.isFunction(e.completed)?e.completed:l.noop,o=e.crossOrigin,a=e.existingVideo,s=e.lastCameraStream,u=e.options,c=e.webcamVideoElement,d=l.isElement(a)?a:c||r.createElement("video");o&&(d.crossOrigin=u.crossOrigin),d.autoplay=!0,d.loop=!0,d.muted=!0,d.addEventListener("loadeddata",(function(e){_.loadedData=!0,u.offset&&(d.currentTime=u.offset)})),a?_.stream({videoElement:d,existingVideo:a,completedCallback:n}):s?_.stream({videoElement:d,cameraStream:s,streamedCallback:i,completedCallback:n}):l.getUserMedia({video:!0},(function(e){_.stream({videoElement:d,cameraStream:e,streamedCallback:i,completedCallback:n})}),t)},startVideoStreaming:function(e){var t=arguments.length>1&&arguments[1]!==a?arguments[1]:{},i=t.timeout!==a?t.timeout:0,n=t.callback,r=t.webcamVideoElement,o=void 0;i>0&&(o=l.requestTimeout((function(){_.onStreamingTimeout(n)}),1e4)),_.startStreaming({error:function(){n({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(o)},completed:function(){var t=arguments.length>0&&arguments[0]!==a?arguments[0]:{},i=t.cameraStream,n=t.videoElement,r=t.videoHeight,o=t.videoWidth;e({cameraStream:i,videoElement:n,videoHeight:r,videoWidth:o})},lastCameraStream:t.lastCameraStream,webcamVideoElement:r,crossOrigin:t.crossOrigin,options:t})},stopVideoStreaming:function(e){var t=e=l.isObject(e)?e:{},i=t.keepCameraOn,n=t.videoElement,r=t.webcamVideoElement,o=e.cameraStream||{},a=o.getTracks&&o.getTracks()||[],s=!!a.length,u=a[0];!i&&s&&l.isFunction(u.stop)&&u.stop(),l.isElement(n)&&!r&&(n.pause(),l.isFunction(l.URL.revokeObjectURL)&&!l.webWorkerError&&n.src&&l.URL.revokeObjectURL(n.src),l.removeElement(n))}};function S(e){e=l.isObject(e)?e:{},_.stopVideoStreaming(e)}function C(e,t){var i=e.options||{},n=i.images,o=i.video,s=Number(i.gifWidth),u=Number(i.gifHeight),c=(Number(i.numFrames),e.cameraStream),d=e.videoElement,h=e.videoWidth,f=e.videoHeight,m=function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.videoWidth,i=e.videoHeight,n=e.gifWidth,r=e.gifHeight,o={width:0,height:0,scaledWidth:0,scaledHeight:0};return t>i?(o.width=Math.round(t*(r/i))-n,o.scaledWidth=Math.round(o.width*(i/r))):(o.height=Math.round(i*(n/t))-r,o.scaledHeight=Math.round(o.height*(t/n))),o}({videoWidth:h,videoHeight:f,gifHeight:u,gifWidth:s}),v=t;i.crop=m,i.videoElement=d,i.videoWidth=h,i.videoHeight=f,i.cameraStream=c,l.isElement(d)&&(d.width=s+m.width,d.height=u+m.height,i.webcamVideoElement||(l.setCSSAttr(d,{position:"fixed",opacity:"0"}),r.body.appendChild(d)),d.play(),E(i,(function(e){n&&n.length||o&&o.length||S(e),v(e)})))}function x(e,t){if(t=l.isFunction(e)?e:t,e=l.isObject(e)?e:{},l.isFunction(t)){var i=l.mergeOptions(m,e)||{},n=e.cameraStream,o=i.images,s=o?o.length:0,u=i.video,c=i.webcamVideoElement;i=l.mergeOptions(i,{gifWidth:Math.floor(i.gifWidth),gifHeight:Math.floor(i.gifHeight)}),s?function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,i=e.images,n=e.options,o=e.imagesLength,s={getUserMedia:!0,"window.URL":!0},u=d.validate(s),c=[],h=0,f=void 0,m=void 0;if(u.error)return t(u);function v(){l.each(c,(function(e,t){t&&(t.text?m.addFrame(t.img,n,t.text):m.addFrame(t,n))})),M(m,t)}m=new T(n),l.each(i,(function(e,i){var a=i;i.src&&(a=a.src),l.isElement(a)?(n.crossOrigin&&(a.crossOrigin=n.crossOrigin),c[e]=a,(h+=1)===o&&v()):l.isString(a)&&(f=new Image,n.crossOrigin&&(f.crossOrigin=n.crossOrigin),function(n){i.text&&(n.text=i.text),n.onerror=function(e){var i=void 0;if(0==--o)return(i={}).error="None of the requested images was capable of being retrieved",t(i)},n.onload=function(t){i.text?c[e]={img:n,text:n.text}:c[e]=n,(h+=1)===o&&v(),l.removeElement(n)},n.src=a}(f),l.setCSSAttr(f,{position:"fixed",opacity:"0"}),r.body.appendChild(f))}))}({images:o,imagesLength:s,callback:t,options:i}):u?function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,i=e.existingVideo,n=e.options,r={getUserMedia:!0,"window.URL":!0},o=d.validate(r),s=void 0,u=void 0;if(o.error)return t(o);if(l.isElement(i)&&i.src){if(u=i.src,s=l.getExtension(u),!l.isSupported.videoCodecs[s])return t(d.messages.videoCodecs)}else l.isArray(i)&&l.each(i,(function(e,t){if(s=t instanceof Blob?t.type.substr(t.type.lastIndexOf("/")+1,t.length):t.substr(t.lastIndexOf(".")+1,t.length),l.isSupported.videoCodecs[s])return i=t,!1}));_.startStreaming({completed:function(e){e.options=n||{},C(e,t)},existingVideo:i,crossOrigin:n.crossOrigin,options:n})}({existingVideo:u,callback:t,options:i}):function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,i=e.lastCameraStream,n=e.options,r=e.webcamVideoElement;if(!p())return t(d.validate());n.savedRenderingContexts.length?E(n,(function(e){t(e)})):_.startVideoStreaming((function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{};e.options=n||{},C(e,t)}),{lastCameraStream:i,callback:t,webcamVideoElement:r,crossOrigin:n.crossOrigin})}({lastCameraStream:n,callback:t,webcamVideoElement:c,options:i})}}var P={utils:c,error:h,defaultOptions:v,createGIF:x,takeSnapShot:function(e,t){if(t=l.isFunction(e)?e:t,e=l.isObject(e)?e:{},l.isFunction(t)){var i=l.mergeOptions(m,e);x(l.mergeOptions(i,{interval:.1,numFrames:1,gifWidth:Math.floor(i.gifWidth),gifHeight:Math.floor(i.gifHeight)}),t)}},stopVideoStreaming:S,isSupported:function(){return d.isValid()},isWebCamGIFSupported:p,isExistingVideoGIFSupported:function(e){var t=!1;if(l.isArray(e)&&e.length){if(l.each(e,(function(e,i){l.isSupported.videoCodecs[i]&&(t=!0)})),!t)return!1}else if(l.isString(e)&&e.length&&!l.isSupported.videoCodecs[e])return!1;return d.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return d.isValid({getUserMedia:!0})},VERSION:"0.4.5"};(i=function(){return P}.apply(t,[]))===a||(e.exports=i)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})},428:function(e){"use strict";e.exports=THREE}},t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(341)}();
//# sourceMappingURL=main.4e6335b22d040325681c.js.map